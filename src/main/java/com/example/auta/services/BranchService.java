package com.example.auta.services;import com.example.auta.domain.entities.BranchEntity;import com.example.auta.domain.repositories.BranchRepository;import com.example.auta.models.classes.Branch;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import java.util.stream.Collectors;@Servicepublic class BranchService {    private final BranchRepository branchRepository;    private final CarService carService;    @Autowired    public BranchService(BranchRepository branchRepo,                         CarService carService){        this.branchRepository = branchRepo;        this.carService = carService;    }    public BranchEntity saveBranch(Branch branch) {        return branchRepository.saveAndFlush(map(branch));    }    public Branch readBranch(BranchEntity branch) {        return map(branch);    }    private BranchEntity map(Branch branch) {        return BranchEntity.builder()                .address(branch.getAddress())                .cars(branch.getCars()                              .stream()                              .map(carService::saveCar)                              .collect(Collectors.toList()))                .employees(branch.getEmployees())                .build();    }    @Transactional    public Branch map(BranchEntity branch) {        return Branch.builder()                .address(branch.getAddress())                .cars(branch.getCars()                              .stream()                              .map(carService::readCar)                              .collect(Collectors.toList()))                .employees(branch.getEmployees())                .build();    }}